/* =========================================================================
   5-FU App — Modern Theme (NO inner scrollbars, Page-level sticky header)
   ========================================================================= */

/* =========================
   Color System (Modern)
   ========================= */
:root{
  /* Background & Surfaces (modern dark navy) */
  --bg:#0B1220;
  --surface:#0F1B2D;
  --panel:#12243A;
  --card:#152742;

  /* Text */
  --text:#E6EEF6;
  --text-muted:#B7C4D5;
  --text-dim:#9AA9BE;

  /* Accents */
  --primary:#7DD3FC;      /* cyan-300 */
  --primary-600:#38BDF8;  /* cyan-400 */
  --primary-700:#0891B2;  /* cyan-700 */

  --accent:#F59E0B;       /* amber-500 */
  --accent-700:#B45309;

  /* States */
  --error:#EF4444;        /* red-500 */
  --success:#34D399;      /* emerald-400 */
  --warning:#F59E0B;

  /* Borders & Shadows */
  --border:rgba(255,255,255,0.10);
  --border-strong:rgba(255,255,255,0.22);
  --shadow-1:0 10px 30px rgba(0,0,0,0.35);
  --shadow-2:0 18px 44px rgba(0,0,0,0.45);

  /* Inputs */
  --input-bg:#0F223A;
  --input-focus:#7DD3FC;

  /* Pills / Chips */
  --pill-bg:rgba(255,255,255,0.06);
  --pill-text:#E6EEF6;

  /* Radii */
  --radius-sm:10px;
  --radius:14px;
  --radius-lg:20px;

  /* Table header/backgrounds */
  --table-header:rgba(255,255,255,0.06);
  --table-row:rgba(255,255,255,0.03);
  --table-row-alt:rgba(255,255,255,0.05);

  /* CTCAE grade palette (subtle) */
  --g0:#1e293b;  /* slate-800 */
  --g1:#22c55e;  /* green-500 */
  --g2:#84cc16;  /* lime-500 */
  --g3:#eab308;  /* yellow-500 */
  --g4:#ef4444;  /* red-500 */

  /* Table defaults */
  --ft-width: 100%;
  --ft-minw: 0px;

  /* Theme solids */
  --ft-header-solid: #152742;
  --ft-firstcol-solid: #1A2E51;
  --ft-secondcol-solid:#162B4B;
  --ft-lastcol-solid:  #162B4B;

  /* Sticky offset for page-level header (change if you have a fixed top bar) */
  --sticky-offset: 0px;
}

/* =========================
   Base
   ========================= */
*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  font: 14px/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  color: var(--text);
  background:
    radial-gradient(1200px 800px at 10% 0%, rgba(56,189,248,0.10), transparent 60%),
    radial-gradient(1200px 800px at 90% 100%, rgba(245,158,11,0.08), transparent 60%),
    linear-gradient(180deg, var(--bg) 0%, #0A1020 100%);
}

/* =========================
   Layout
   ========================= */
.container{
  width: 100%;
  max-width: 100%;
  margin: 0 auto;
  padding: 24px;
}
.section-title{ display:flex; align-items:center; justify-content:space-between; margin:12px 0 8px; }
.section-title h3{ margin:0; font-size:18px; font-weight:700; color:var(--text); letter-spacing:.2px; }
.muted{ color: var(--text-muted); }
.text-lg{ font-size:22px; }
.font-semibold{ font-weight:700; }
.flex{ display:flex; }
.grid{ display:grid; }
.gap-1{ gap:8px; }
.gap-2{ gap:12px; }
.items-center{ align-items:center; }
.justify-between{ justify-content:space-between; }
.mb-1{ margin-bottom:8px; }
.mt-1{ margin-top:8px; }
.mt-2{ margin-top:16px; }

/* =========================
   Cards
   ========================= */
.card{
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)) , var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-1);
  padding: 14px;
  backdrop-filter: saturate(120%) blur(6px);
}
.card.soft{ background: rgba(255,255,255,0.04); border-color: var(--border); }

/* =========================
   Inputs
   ========================= */
input[type="text"], input[type="number"], input[type="date"], select, textarea{
  width:100%; padding:10px 12px; color: var(--text); background: var(--input-bg);
  border:1px solid var(--border); border-radius: var(--radius-sm); outline: none;
  transition: border-color .15s, box-shadow .15s, background .15s, transform .05s;
}
textarea{ min-height: 100px; resize: vertical; }
input::placeholder, textarea::placeholder{ color: var(--text-dim); }
input:focus, select:focus, textarea:focus{ border-color: var(--input-focus); box-shadow: 0 0 0 3px rgba(125,211,252,0.22); }
.form-group label{ display:block; margin-bottom:6px; color: var(--text-muted); font-size:12px; letter-spacing:.25px; }

/* =========================
   Buttons
   ========================= */
.btn{
  --btn-bg: var(--pill-bg); --btn-text: var(--text);
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  padding:10px 16px; border-radius: 999px; background: var(--btn-bg); color: var(--btn-text);
  border:1px solid var(--border); cursor:pointer; transition: transform .06s, background .2s, border-color .2s, box-shadow .2s;
  box-shadow: 0 6px 18px rgba(0,0,0,0.12);
}
.btn:hover{ transform: translateY(-1px); border-color: var(--border-strong); }
.btn:active{ transform: translateY(0); }
.btn-primary{ --btn-bg: var(--primary); --btn-text: #06202B; border-color: transparent; font-weight:700; }
.btn-primary:hover{ background: var(--primary-600); }
.btn-primary:active{ background: var(--primary-700); color:#E6F6FB; }
.btn-danger{ --btn-bg: #B33A3A; --btn-text: #fff; border-color: rgba(0,0,0,0.1); }
.btn-icon{ width:38px; height:38px; padding:0; border-radius:999px; font-size:18px; }

/* تحسين أزرار Actions داخل الجداول */
.table td:last-child .btn{
  width:36px; height:36px; padding:0; border-radius:999px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: none;
}
.table td:last-child .btn:hover{
  background: rgba(125,211,252,0.18);
  border-color: rgba(125,211,252,0.35);
}

/* =========================
   Pills / badges
   ========================= */
.pill{
  display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
  background: var(--pill-bg); color: var(--pill-text); border:1px solid var(--border); font-size:12px;
}
.badge{
  display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px;
  background:rgba(245,158,11,0.16); color:#FFE1A6; font-weight:700; font-size:11px;
}

/* =========================
   Tables (generic) — NO inner scrollbars, PAGE-LEVEL sticky header
   ========================= */
.table{
  border-collapse: separate;
  border-spacing:0;
  border-radius: var(--radius);
  border:1px solid var(--border);

  /* امتداد كامل وبدون أي overflow داخلي */
  display: block;
  width: var(--ft-width);
  max-height: none;
  overflow: visible;
  margin: 0 auto;
  min-width: var(--ft-minw);
}

.table thead, .table tbody{
  display: table;
  width: 100%;
  table-layout: fixed;
}

/* === Page-level sticky header === */
.table thead{
  position: sticky;
  top: var(--sticky-offset);
  z-index: 5;
}
.table thead th{
  background: var(--ft-header-solid) !important;
  color: var(--text-muted);
  font-weight:700;
  text-align:center;
  font-size:12px;
  padding:10px 12px;
  border-bottom:1px solid var(--border);
}

.table tbody{
  display: block;
}
.table thead th:first-child,
.table tbody td:first-child{ text-align:left; }
.table tbody td{
  padding:10px 12px;
  border-bottom:1px solid var(--border);
  background: var(--table-row);
  color: var(--text);
  text-align:center;
}
.table tbody tr:nth-child(even) td{ background: var(--table-row-alt); }
.table tbody tr{ cursor: pointer; transition: background .15s ease; }
.table tbody tr:hover td{ background: rgba(255,255,255,0.08); }

/* =========================
   Header toolbar (filters)
   ========================= */
.header-bar{
  position: sticky; top: 0; z-index: 50;
  background: linear-gradient(90deg, rgba(125,211,252,0.10), rgba(245,158,11,0.10));
  border: 1px solid var(--border); border-radius: var(--radius-lg);
  padding: 12px; margin-top: 8px; margin-bottom: 10px; box-shadow: 0 12px 24px rgba(0,0,0,0.14);
}
.flexible-controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin: 6px 0 10px; }
.flexible-controls .form-group{ min-width: 160px; }

/* =========================
   Modal (generic)
   ========================= */
.modal-wrap{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:999; }
.modal-overlay{ position:absolute; inset:0; background: rgba(0,0,0,0.45); backdrop-filter: blur(2px); }
.modal{
  position:relative; z-index:1; width:min(1000px, calc(100vw - 28px)); max-height: calc(100vh - 28px); overflow:auto;
  background: var(--surface); border:1px solid var(--border-strong); border-radius: 24px; box-shadow: var(--shadow-2);
}
.modal-header{ position:sticky; top:0; padding:14px 16px; background: linear-gradient(180deg, var(--surface) 0%, #152742 100%); border-bottom:1px solid var(--border); border-top-left-radius: 24px; border-top-right-radius: 24px; }
.modal-body{ padding:16px; }
.modal-footer{ position:sticky; bottom:0; display:flex; gap:10px; justify-content:flex-end; padding:12px 16px; background: linear-gradient(0deg, var(--surface) 0%, #152742 100%); border-top:1px solid var(--border); border-bottom-left-radius: 24px; border-bottom-right-radius: 24px; }

/* =========================
   Links
   ========================= */
a{ color: var(--primary); text-decoration: none; }
a:hover{ text-decoration: underline; }

/* =========================
   Scrollbars (page-level only)
   ========================= */
*::-webkit-scrollbar{ width:12px; height:12px; }
*::-webkit-scrollbar-thumb{ background: rgba(255,255,255,0.16); border-radius: 999px; border:3px solid transparent; background-clip: padding-box; }
*::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,0.28); }
*::-webkit-scrollbar-track{ background: transparent; }

/* =========================
   Grade bar locking
   ========================= */
.grade-bar.disabled{ opacity: .55; pointer-events: none; }

/* =========================
   Sticky form actions
   ========================= */
.form-sticky-actions{
  position: sticky; bottom: -1px; display: flex; gap: 10px; justify-content: flex-end;
  padding-top: 8px; margin-top: 8px; background: linear-gradient(180deg, transparent, rgba(0,0,0,0.12)); border-top: 1px solid var(--border);
}

/* Badge hidden helper */
#ph_due_badge.hidden{ display:none; }

/* =========================
   Shimmer loading skeleton
   ========================= */
@keyframes shimmer{ 0%{ background-position: -468px 0; } 100%{ background-position: 468px 0; } }
.shimmer{
  display:block; height:12px; width:100%;
  background: linear-gradient(to right, rgba(255,255,255,0.06) 8%, rgba(255,255,255,0.16) 18%, rgba(255,255,255,0.06) 33%);
  background-size: 800px 104px; border-radius: 6px;
  animation: shimmer 1.1s linear infinite forwards;
}

/* =========================
   Due state row highlights
   ========================= */
tr.row-due-today td{ background: rgba(245,158,11,0.18) !important; border-left: 3px solid rgba(245,158,11,0.8); }
tr.row-overdue td{ background: rgba(239,68,68,0.18) !important; border-left: 3px solid rgba(239,68,68,0.85); }
tr.row-due-today:hover td, tr.row-overdue:hover td{ filter: brightness(1.05); }

/* =========================
   Saved assessments: FULL WIDTH + Fixed Column Widths + Alignment (NO inner scroll)
   ========================= */

/* الغلاف: لا سكرول داخلي، اتركه للصفحة */
#saved-assessments{
  max-height: none;
  overflow: visible;
  border-radius: var(--radius);
}

/* الجدول: اتساع كامل + تخطيط ثابت + بدون overflow داخلي */
#saved-assessments table.table{
  width: 100% !important;
  min-width: 0 !important;
  max-width: 100% !important;
  overflow-x: visible !important;
  overflow-y: visible !important;
  table-layout: fixed;
  border-collapse: separate;
}

/* ========== عرض الأعمدة (11 عمودًا) — مجموع 100% ==========
   1 Name            24%
   2 ID               7%
   3 Next follow-up  10%
   4 1st date 5FU     9%
   5 Mucositis        6%
   6 Diarrhea         6%
   7 Neutropenia      6%
   8 DPYD            12%
   9 Other tox       10%
   10 Other grade     4%
   11 Actions         6%
*/
#saved-assessments table.table thead th:nth-child(1),
#saved-assessments table.table tbody td:nth-child(1){ width:24%; }
#saved-assessments table.table thead th:nth-child(2),
#saved-assessments table.table tbody td:nth-child(2){ width:7%; }
#saved-assessments table.table thead th:nth-child(3),
#saved-assessments table.table tbody td:nth-child(3){ width:10%; }
#saved-assessments table.table thead th:nth-child(4),
#saved-assessments table.table tbody td:nth-child(4){ width:9%; }
#saved-assessments table.table thead th:nth-child(5),
#saved-assessments table.table tbody td:nth-child(5){ width:6%; }
#saved-assessments table.table thead th:nth-child(6),
#saved-assessments table.table tbody td:nth-child(6){ width:6%; }
#saved-assessments table.table thead th:nth-child(7),
#saved-assessments table.table tbody td:nth-child(7){ width:6%; }
#saved-assessments table.table thead th:nth-child(8),
#saved-assessments table.table tbody td:nth-child(8){ width:12%; }
#saved-assessments table.table thead th:nth-child(9),
#saved-assessments table.table tbody td:nth-child(9){ width:10%; }
#saved-assessments table.table thead th:nth-child(10),
#saved-assessments table.table tbody td:nth-child(10){ width:4%; }
#saved-assessments table.table thead th:nth-child(11),
#saved-assessments table.table tbody td:nth-child(11){ width:6%; }

/* محاذاة: الوسط للأعمدة الرقمية/التواريخ، ويسار للحقول النصية الطويلة */
#saved-assessments table.table thead th:nth-child(1),
#saved-assessments table.table tbody td:nth-child(1),
#saved-assessments table.table thead th:nth-child(2),
#saved-assessments table.table tbody td:nth-child(2),
#saved-assessments table.table thead th:nth-child(9),
#saved-assessments table.table tbody td:nth-child(9){ text-align: left; }
#saved-assessments table.table thead th:nth-child(3),
#saved-assessments table.table tbody td:nth-child(3),
#saved-assessments table.table thead th:nth-child(4),
#saved-assessments table.table tbody td:nth-child(4),
#saved-assessments table.table thead th:nth-child(5),
#saved-assessments table.table tbody td:nth-child(5),
#saved-assessments table.table thead th:nth-child(6),
#saved-assessments table.table tbody td:nth-child(6),
#saved-assessments table.table thead th:nth-child(7),
#saved-assessments table.table tbody td:nth-child(7),
#saved-assessments table.table thead th:nth-child(8),
#saved-assessments table.table tbody td:nth-child(8),
#saved-assessments table.table thead th:nth-child(10),
#saved-assessments table.table tbody td:nth-child(10),
#saved-assessments table.table thead th:nth-child(11),
#saved-assessments table.table tbody td:nth-child(11){ text-align: center; }

/* إزاحة خفيفة لعنوان عمود Other grade (العمود 10) */
#saved-assessments table.table thead th:nth-child(10){
  text-align: left !important;
  padding-left: 18px;
}

/* قصّ نص الأعمدة الطويلة (بدون word-wrap) + خط موحّد للتواريخ */
#saved-assessments table.table tbody td:nth-child(8),
#saved-assessments table.table tbody td:nth-child(9){
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
#saved-assessments table.table tbody td:nth-child(3),
#saved-assessments table.table tbody td:nth-child(4){
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

/* =========================
   Toast (visual only)
   ========================= */
.toast{
  padding: 10px 12px;
  border-radius: 12px;
  box-shadow: var(--shadow-1);
  color: #06131D;
  font-weight: 700;
  border: 1px solid var(--border);
}
.toast.success{ background:#D1FAE5; }
.toast.warn{ background:#FFF3CD; }
.toast.error{ background:#F8D7DA; }
